<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>LockLoom Device Owner Policies & Runtime Permission Disclosure</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --fg:#0b1b13; --muted:#41584b; --accent:#1b5e20;
      --bg:#f7faf8; --panel:#ffffff; --warn:#7a1b1b;
    }
    body { margin:0; font:16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:var(--fg); background:var(--bg); }
    header { background:var(--panel); border-bottom:1px solid #e7eee9; padding:24px; }
    h1 { margin:0 0 4px 0; font-size:22px; color:var(--accent); }
    h2 { margin:28px 0 12px; font-size:18px; color:var(--accent); }
    h3 { margin:22px 0 8px; font-size:16px; color:var(--muted); }
    main { max-width:960px; margin:0 auto; padding:24px; }
    .badge { display:inline-block; padding:6px 10px; border-radius:999px; background:#e8f5e9; color:#0f4d19; font-weight:600; font-size:13px; }
    .panel { background:var(--panel); border:1px solid #e7eee9; border-radius:10px; padding:16px; margin:16px 0; }
    .grid { display:grid; grid-template-columns: 1fr; gap:12px; }
    @media (min-width:800px){ .grid{ grid-template-columns: 1.2fr 2fr; } }
    table { width:100%; border-collapse:collapse; background:var(--panel); }
    th, td { text-align:left; padding:10px 12px; border-bottom:1px solid #eef3ef; vertical-align:top; }
    th { background:#f5fbf7; font-weight:700; }
    code { background:#f0f6f2; padding:2px 6px; border-radius:6px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 85%; }
    .note { font-size:14px; color:var(--muted); }
    .warn { color:var(--warn); font-weight:600; }
    .list { margin:8px 0 0 18px; }
  </style>
</head>
<body>
  <header>
    <h1>LockLoom ‚Äî Device Policy Disclosure</h1>
    <div class="badge">Zero-Exfil Commitment</div>
    <p class="note" style="margin-top:8px">
      This device owner (DO) configuration is intentionally designed for <strong>zero data exfiltration</strong>.
      The app does not transmit photos, audio, video, telemetry, or identifiers to any backend. All ‚Äúnetwork‚Äù
      integrations in code are <em>no-op delegates</em>, and the control-plane base URL is disabled.
    </p>
  </header>

  <main>    <!-- GOOGLE PLAY COMPLIANCE - IN-APP CONSENT DISCLOSURES -->
    <section class="panel" style="border-left:4px solid var(--accent); background:#e8f5e9;">
      <h2 style="margin-top:0;">üîê Google Play User Data Policy Compliance</h2>
      <p>
        LockLoom implements <strong>two separate in-app consent disclosures</strong> for sensitive data access,
        each complying with <a href="https://support.google.com/googleplay/android-developer/answer/10144311" target="_blank">Google Play's User Data Policy</a>.
        Consent is <strong>immutably recorded</strong> with timestamps and functionality is <strong>gated until consent is granted</strong>.
      </p>
    </section>

    <!-- ACCESSIBILITY CONSENT SECTION -->
    <section>
      <h2>1Ô∏è‚É£ Accessibility Service Consent</h2>
      <div class="panel" style="border:2px solid #1565c0; background:#e3f2fd;">
        <h3 style="color:#1565c0; margin-top:0;">What Data is Accessed</h3>
        <p>LockLoom's optional AccessibilityService monitors <strong>app launch events</strong> (window state changes) to:</p>
        <ul class="list">
          <li>Pause or hide protected apps until authentication succeeds</li>
          <li>Log policy bypass attempts for local security telemetry</li>
          <li>Detect distress PIN entry on the system lock screen for covert SOS triggers</li>
        </ul>
        <p><strong>Data stays on-device:</strong> Launch events are processed transiently and never transmitted off-device.</p>

        <h3 style="color:#1565c0;">In-App Consent Implementation</h3>
        <table style="background:transparent; border:none;">
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Disclosure Location:</td>
            <td style="border:none; padding:4px 0;">Dedicated "Launch Monitoring Disclosure" screen shown during normal app usage</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Consent Mechanism:</td>
            <td style="border:none; padding:4px 0;">Checkbox ("I understand and consent to LockLoom monitoring app launches for enforcement") + "Continue to Android settings" button</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Persistence:</td>
            <td style="border:none; padding:4px 0;">Consent timestamp immutably recorded in device-protected storage (<code>SharedPreferences</code>)</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Feature Gating:</td>
            <td style="border:none; padding:4px 0;">AccessibilityService cannot be enabled until consent is recorded; distress PIN setup is blocked without accessibility consent</td>
          </tr>
        </table>

        <h3 style="color:#1565c0;">Google Play Policy Compliance</h3>
        <table>
          <thead>
            <tr><th>Requirement</th><th>Implementation</th></tr>
          </thead>
          <tbody>
            <tr><td>Comprehensively discloses data collection, use, and sharing</td><td>‚úÖ Screen explains what is monitored, why, and that data never leaves device</td></tr>
            <tr><td>Within the app itself, displayed in normal usage</td><td>‚úÖ Dedicated in-app screen, not buried in settings</td></tr>
            <tr><td>Cannot only be in privacy policy or ToS</td><td>‚úÖ Standalone in-app disclosure, separate from external policies</td></tr>
            <tr><td>Cannot be combined with unrelated disclosures</td><td>‚úÖ Dedicated to accessibility monitoring only</td></tr>
            <tr><td>Requires affirmative user action</td><td>‚úÖ Checkbox must be checked + button must be tapped</td></tr>
            <tr><td>Navigation away is NOT consent</td><td>‚úÖ Feature remains disabled if user navigates away</td></tr>
            <tr><td>No auto-dismiss or expiring messages</td><td>‚úÖ Disclosure persists until explicit user action</td></tr>
            <tr><td>Must be obtained BEFORE data collection</td><td>‚úÖ Service cannot be enabled until consent recorded</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- PHONE DATA CONSENT SECTION -->
    <section>
      <h2>2Ô∏è‚É£ Phone Number Data Consent</h2>
      <div class="panel" style="border:2px solid #c62828; background:#ffebee;">
        <h3 style="color:#c62828; margin-top:0;">What Data is Collected</h3>
        <p>LockLoom collects phone numbers you provide as <strong>emergency contacts</strong> to enable the Distress Flare feature:</p>
        <ul class="list">
          <li><strong>Phone numbers</strong> you enter as emergency contacts (stored locally on device only)</li>
          <li><strong>SMS messages</strong> sent directly to these contacts when you trigger a distress PIN</li>
          <li><strong>Your device's phone number</strong> may be included in alerts to identify the sender</li>
          <li><strong>GPS location</strong> (if available) included in distress alerts to help contacts locate you</li>
        </ul>
        <p><strong>Direct to contacts only:</strong> Alerts are sent directly to your configured emergency contacts via SMS/email ‚Äî <em>never</em> through any LockLoom server or third-party relay.</p>

        <h3 style="color:#c62828;">In-App Consent Implementation</h3>
        <p>LockLoom implements <strong>two layered consent mechanisms</strong> for phone number data:</p>
        
        <h4 style="margin-bottom:8px;">A. Phone Data Disclosure Dialog (Build 313+)</h4>
        <table style="background:transparent; border:none;">
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Disclosure Location:</td>
            <td style="border:none; padding:4px 0;">Modal dialog shown when user attempts to save phone numbers as emergency contacts</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Consent Mechanism:</td>
            <td style="border:none; padding:4px 0;">Checkbox ("I understand and consent to this data collection") + "I Agree" button</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Modal Properties:</td>
            <td style="border:none; padding:4px 0;"><code>dismissOnBackPress=false</code>, <code>dismissOnClickOutside=false</code> ‚Äî cannot be dismissed without explicit action</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Persistence:</td>
            <td style="border:none; padding:4px 0;">Consent timestamp stored in <code>PhoneDataConsentStore</code> (device-protected storage) with version tracking</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Feature Gating:</td>
            <td style="border:none; padding:4px 0;">Phone numbers cannot be saved until consent is recorded</td>
          </tr>
        </table>

        <h4 style="margin-bottom:8px;">B. Distress PIN Data Sharing Consent (Build 347+)</h4>
        <table style="background:transparent; border:none;">
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Disclosure Location:</td>
            <td style="border:none; padding:4px 0;">Inline card displayed directly above distress PIN entry fields</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Consent Mechanism:</td>
            <td style="border:none; padding:4px 0;">Checkbox ("I understand my phone number will be shared with my emergency contacts when I trigger a distress alert") + "I Acknowledge" button</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Persistence:</td>
            <td style="border:none; padding:4px 0;">Separate consent timestamp recorded with date display ("Acknowledged: YYYY-MM-DD HH:MM")</td>
          </tr>
          <tr>
            <td style="border:none; padding:4px 12px 4px 0; font-weight:600;">Feature Gating:</td>
            <td style="border:none; padding:4px 0;">Distress PIN cannot be set until BOTH accessibility consent AND data sharing consent are granted</td>
          </tr>
        </table>

        <h3 style="color:#c62828;">Google Play Policy Compliance</h3>
        <table>
          <thead>
            <tr><th>Requirement</th><th>Implementation</th></tr>
          </thead>
          <tbody>
            <tr><td>Comprehensively discloses data collection, use, and sharing</td><td>‚úÖ Explains what data is collected, how it's used (SMS alerts), and who receives it (your emergency contacts only)</td></tr>
            <tr><td>Within the app itself, displayed in normal usage</td><td>‚úÖ Modal dialog + inline card on Distress PIN screen</td></tr>
            <tr><td>Cannot only be in privacy policy or ToS</td><td>‚úÖ In-app disclosure components, separate from this external document</td></tr>
            <tr><td>Cannot be combined with unrelated disclosures</td><td>‚úÖ Dedicated to phone number data only (separate from accessibility consent)</td></tr>
            <tr><td>Requires affirmative user action</td><td>‚úÖ Checkbox must be checked + button must be tapped</td></tr>
            <tr><td>Navigation away is NOT consent</td><td>‚úÖ Modal cannot be dismissed; features remain disabled if user declines</td></tr>
            <tr><td>No auto-dismiss or expiring messages</td><td>‚úÖ Disclosures persist until explicit user action</td></tr>
            <tr><td>Must be obtained BEFORE data collection</td><td>‚úÖ Phone numbers cannot be saved and PIN cannot be set until consent recorded</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- CONSENT ARCHITECTURE SUMMARY -->
    <section class="panel" style="border:2px solid var(--accent);">
      <h2 style="margin-top:0;">Consent Architecture Summary</h2>
      <table>
        <thead>
          <tr>
            <th>Feature</th>
            <th>Required Consents</th>
            <th>Storage</th>
            <th>Gating Behavior</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Accessibility Service</td>
            <td>Accessibility Consent only</td>
            <td>Device-protected <code>SharedPreferences</code></td>
            <td>Service cannot be enabled in Android settings until consent recorded</td>
          </tr>
          <tr>
            <td>Save Emergency Phone Numbers</td>
            <td>Phone Data Consent</td>
            <td><code>PhoneDataConsentStore</code> (device-protected)</td>
            <td>Save button triggers consent dialog if not already granted</td>
          </tr>
          <tr>
            <td>Set Distress PIN</td>
            <td><strong>BOTH</strong> Accessibility + Data Sharing Consent</td>
            <td>Separate timestamps for each</td>
            <td>Submit button blocked with toast explaining which consent(s) missing</td>
          </tr>
        </tbody>
      </table>
      <p class="note" style="margin-top:12px;">
        <strong>Immutability:</strong> All consent timestamps are written to device-protected storage using <code>SharedPreferences.edit().apply()</code>.
        Once recorded, consent cannot be retroactively modified ‚Äî only revoked by the user through explicit action.
        Consent version tracking ensures users must re-consent if disclosure text changes materially.
      </p>
    </section>
    <!-- WHY THIS PAGE EXISTS -->
    <section class="panel">
      <h2>What this page covers</h2>
      <p>
        This disclosure enumerates every <strong>DevicePolicyManager</strong> capability the app uses as device owner,
        and explains why each is required. It also includes an <strong>addendum</strong> listing the normal
        <em>runtime permissions</em> the app may request at the OS level (those are not ‚Äúdevice policies,‚Äù but auditors
        often review them together).
      </p>
    </section>

    <!-- DEVICE OWNER POLICIES -->
    <section>
      <h2>Device Owner (DO) Policies Used</h2>
      <table aria-label="Device Owner Policies">
        <thead>
          <tr>
            <th style="width:28%">Policy / API (scope)</th>
            <th>Purpose & Behavior (why it‚Äôs needed)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>lockNow</code> via <em>DeviceLockController</em> (DO)</td>
            <td>
              Allows the app to <strong>immediately lock</strong> the device in response to policy violations
              (e.g., integrity attestation failure, kill-switch absence, session watchdog timeout).
              This is a <em>local</em> action; no data leaves the device.
            </td>
          </tr>
          <tr>
            <td><code>wipeDevice</code> via <em>ShutdownController</em> (DO)</td>
            <td>
              Enables <strong>factory reset</strong> escalation after repeated integrity failures or explicit policy triggers.
              Used only under well-defined thresholds; again, this is a device-local action with zero network use.
            </td>
          </tr>
          <tr>
            <td><code>setApplicationHidden</code> (DO)</td>
            <td>
              Supports the ‚ÄúHidden Workspace‚Äù: selected, already-protected apps can be <strong>hidden/unhidden</strong>
              on the device. Hiding affects launcher visibility only; it does not uninstall or export data.
            </td>
          </tr>
          <tr>
            <td><span title="U+1F50C">USB guard</span>:
              <code>setUsbDataSignalingEnabled</code> (Android 14/15+, DO) <br/>
              or legacy <code>addUserRestriction(DISALLOW_USB_FILE_TRANSFER)</code> (Android 7+)</td>
            <td>
              When the paired ‚Äúkill-switch‚Äù device (e.g., Bluetooth tag) is absent and policy requires presence,
              the manager disables USB data signaling (or applies the legacy user restriction) to reduce
              exfil/ingress risk through USB. Automatically <strong>cleared</strong> when the device reconnects or policy no longer requires it.
            </td>
          </tr>
          <tr>
            <td><code>forceStopPackage</code> (Android 7.0+, DO-only)</td>
            <td>
              As part of local ‚Äústream termination,‚Äù the DO can request specific protected apps to be <strong>force-stopped</strong>.
              If unavailable on the platform or not permitted, the code falls back to killing background processes where possible.
              This is entirely local and does not export data.
            </td>
          </tr>
          <tr>
            <td>DO-granted runtime permission state: <code>READ_PHONE_STATE</code></td>
            <td>
              During setup, the DO auto-grants <code>READ_PHONE_STATE</code> to enable <strong>SIM-swap detection</strong>.
              The feature computes a local hash of SIM identifiers and compares it on-device; notifications are local only.
            </td>
          </tr>
          <tr>
            <td>Foreground service management (system-visible notification)</td>
            <td>
              The app runs a persistent <strong>foreground service</strong> (with a user-visible notification) to host local
              monitors (integrity, kill-switch, SOS scheduler). Starting this service is guarded by
              the user-level <code>POST_NOTIFICATIONS</code> permission on Android 13+; no data transmission occurs.
            </td>
          </tr>
        </tbody>
      </table>

      <div class="panel note">
        <strong>Implementation notes:</strong>
        <ul class="list">
          <li>Network loggers/dispatchers (media capture, shutdown, SOS, SIM-swap) are backed by <em>no-op</em> delegates.</li>
          <li>All capture files (photo/audio/video) are stored in app cache, <strong>encrypted locally</strong> for processing,
              then deleted. No upload endpoints are configured.</li>
          <li>Control plane endpoints are initialized as <em>disabled</em>; telemetry queue is cleared on startup.</li>
        </ul>
      </div>
    </section>

    <!-- ACCESSIBILITY DISCLOSURE -->
    <section>
      <h2>Accessibility Service (user-consented, not a device policy)</h2>
      <div class="panel">
        <p>
          The app offers an optional <strong>AccessibilityService</strong> to intercept launches of selected protected apps
          and gate them behind authentication. Enabling it requires explicit user action in system settings
          and an in-app consent record (see <strong>Accessibility Service Consent</strong> section above).
          The service observes <em>window state changes</em> only to identify the foreground package; it does not transmit events off-device.
        </p>
        <p>
          The AccessibilityService also enables <strong>distress PIN detection on the lock screen</strong>, allowing covert SOS triggers
          without visible indicators. This capability requires both Accessibility Consent and Phone Data Consent before activation.
        </p>
      </div>
    </section>

    <!-- SECURITY HARDENING (December 2025) -->
    <section>
      <h2>Security Hardening ‚Äî Runtime Protection (December 2025)</h2>
      <p class="note">
        The following security measures operate <strong>entirely on-device</strong> to protect user data and prevent tampering.
        None of these features transmit data off-device; they are consistent with the <strong>zero-exfil</strong> design.
      </p>
      <table aria-label="Security Hardening Measures">
        <thead>
          <tr>
            <th style="width:28%">Security Measure</th>
            <th>Purpose & Behavior</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>FLAG_SECURE</code> on security activities</td>
            <td>
              All security-critical activities (<code>LockLoomActivity</code>, <code>LaunchSecurityActivity</code>,
              <code>PhoneUnlockInterceptActivity</code>, <code>CustomLockActivity</code>, <code>ReauthActivity</code>)
              apply <code>WindowManager.LayoutParams.FLAG_SECURE</code> to prevent screenshots, screen recording,
              and display on non-secure displays. This protects sensitive authentication screens from capture.
            </td>
          </tr>
          <tr>
            <td>Clipboard auto-clear</td>
            <td>
              <code>ClipboardSecurityManager</code> automatically clears the system clipboard when leaving security
              activities (<code>onStop</code>/<code>onPause</code>). This prevents sensitive data (e.g., PINs, passwords)
              from persisting in clipboard history and being accessible to other apps.
            </td>
          </tr>
          <tr>
            <td>Backup prevention (<code>backup_rules.xml</code>)</td>
            <td>
              Android Auto Backup is configured to exclude <strong>ALL</strong> data domains: <code>sharedpref</code>,
              <code>database</code>, <code>file</code>, <code>cache</code>, <code>external</code>, and <code>root</code>.
              For Android 12+, <code>data_extraction_rules.xml</code> additionally blocks cloud backup and device-to-device
              transfer. This prevents forensic extraction via ADB backup or Google cloud restore.
            </td>
          </tr>
          <tr>
            <td>Runtime integrity detection</td>
            <td>
              <code>RuntimeIntegrityDetector</code> performs on-device checks for tampering indicators:
              <ul class="list" style="margin-top:0.5em;margin-bottom:0">
                <li><strong>Frida/Xposed</strong>: Detects hooking framework artifacts</li>
                <li><strong>Root</strong>: Identifies su binaries, Magisk, SuperSU</li>
                <li><strong>Native hooks</strong>: Scans for LD_PRELOAD, whale, sandhook, epic, lspd, riru</li>
                <li><strong>Debug/Emulator</strong>: Identifies debugging sessions and emulator environments</li>
              </ul>
              Checks use constant-time comparison to prevent timing side-channel attacks. No data is transmitted.
            </td>
          </tr>
          <tr>
            <td>Play Integrity attestation</td>
            <td>
              <code>PlayIntegrityChecker</code> uses Google Play Integrity API for device attestation. The attestation
              verdict is evaluated <em>locally</em> to determine device trust level. Cryptographic nonces prevent
              replay attacks. The nonce and verdict remain on-device.
            </td>
          </tr>
          <tr>
            <td>Memory obfuscation</td>
            <td>
              Security-sensitive strings (detection indicators) are Base64-encoded in <code>ObfuscatedStrings</code>
              and decoded only at runtime. Combined with ProGuard obfuscation (<code>-repackageclasses ''</code>,
              <code>-mergeinterfacesaggressively</code>), this prevents static analysis from identifying security logic.
            </td>
          </tr>
          <tr>
            <td>MFA session hardening</td>
            <td>
              <code>HardenedMfaSessionStore</code> encrypts MFA session tokens with AES-GCM and validates integrity
              via HMAC. Keys are stored in Android Keystore with hardware security module (HSM) backing when available.
              Sessions are bound to the device to prevent token replay.
            </td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- RUNTIME PERMISSIONS ADDENDUM -->
    <section>
      <h2>Runtime Permissions ‚Äî Addendum (non-policy)</h2>
      <p class="note">
        The following are normal app runtime permissions that <em>may</em> be requested by the OS.
        They are <strong>not</strong> DevicePolicyManager controls, but are listed here for audit completeness.
        All uses below are <strong>local-only</strong> and consistent with the zero-exfil posture.
      </p>
      <table aria-label="Runtime Permissions">
        <thead>
          <tr>
            <th style="width:28%">Permission</th>
            <th>Purpose & Behavior</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>android.permission.CAMERA</code></td>
            <td>
              Used for on-device photo/video capture triggered by local codeword actions or integrity workflows.
              Media is encrypted locally and deleted after processing; there is no upload path.
            </td>
          </tr>
          <tr>
            <td><code>android.permission.RECORD_AUDIO</code></td>
            <td>
              Used for on-device audio capture via MediaRecorder. Files are handled as above (local encryption, ephemeral storage, no network).
            </td>
          </tr>
          <tr>
            <td><code>android.permission.READ_PHONE_STATE</code></td>
            <td>
              Required for SIM-swap detection (reading SIM/telephony state). The app stores only a <em>hash</em> of identifiers
              inside app storage and performs comparisons locally. This permission is also DO-granted at setup to ensure continuity.
            </td>
          </tr>
          <tr>
            <td>
              <code>android.permission.BLUETOOTH_CONNECT</code> (Android 12+) <br/>
              <span class="note">or legacy <code>BLUETOOTH</code> / <code>BLUETOOTH_ADMIN</code> on older Android</span>
            </td>
            <td>
              Allows reading connection state of the user-paired ‚Äúkill-switch‚Äù Bluetooth device.
              The app listens to connection broadcasts and queries connected profiles; no device data is uploaded.
            </td>
          </tr>
          <tr>
            <td>
              <code>android.permission.ACCESS_FINE_LOCATION</code> / <code>ACCESS_COARSE_LOCATION</code> (if declared)
            </td>
            <td>
              Used by the optional local SOS beacon to obtain a location fix. Location data is included in distress alerts
              sent directly to user-configured emergency contacts via SMS/email. No location data is sent to LockLoom servers.
              <strong>Requires Phone Data Consent before use.</strong>
            </td>
          </tr>
          <tr>
            <td><code>android.permission.SEND_SMS</code></td>
            <td>
              Used to send SOS/distress alerts directly to emergency contacts via SMS. Messages are sent using Android's
              <code>SmsManager</code> API directly to phone numbers configured by the user. No data is sent to any backend
              or third-party service. <strong>Requires Phone Data Consent before phone numbers can be saved.</strong>
            </td>
          </tr>
          <tr>
            <td><code>android.permission.INTERNET</code></td>
            <td>
              Required for OAuth authentication with Gmail API and SMTP email dispatch. Used only to send distress alerts
              directly to user-configured emergency contacts. No telemetry, analytics, or data is sent to LockLoom servers.
            </td>
          </tr>
          <tr>
            <td><code>android.permission.POST_NOTIFICATIONS</code> (Android 13+)</td>
            <td>
              Required to present the persistent notification for the foreground service. If not granted, the service defers start until the user permits it.
            </td>
          </tr>
        </tbody>
      </table>

      <div class="panel note">
        <strong>Not networked to LockLoom servers:</strong>
        <ul class="list">
          <li>"Network*" classes (e.g., <em>NetworkSosAlertDispatcher</em>, <em>NetworkSimSwapNotifier</em>,
              <em>NetworkFailureEvidenceDispatcher</em>, <em>NetworkRemoteMediaCaptureLogger</em>) are implemented as
              no-ops or pass-through to local droppers, guaranteeing no transmission to LockLoom servers.</li>
          <li><strong>Distress alerts (SMS, email) go directly to user-configured emergency contacts</strong> ‚Äî never through any LockLoom backend or third-party relay.</li>
          <li>Media capture pipelines delete temporary files after use and never write to shared storage.</li>
          <li>All logs use Logcat only and do <em>not</em> leave the device.</li>
        </ul>
      </div>
    </section>

    <!-- DATA HANDLING -->
    <section>
      <h2>Data Handling & Retention</h2>
      <div class="panel grid">
        <div>
          <h3>Local-only Processing</h3>
          <ul class="list">
            <li>Photos, audio, and video are captured to app cache, encrypted with a device-specific key, and then deleted.</li>
            <li>SIM-swap uses a local hash of SIM info; the previous/current hash lives in app/private storage.</li>
            <li>Accessibility events are observed transiently to gate app launches; they are not exported.</li>
          </ul>
        </div>
        <div>
          <h3>No Control Plane</h3>
          <ul class="list">
            <li>ControlPlaneEndpoints are initialized in a disabled state.</li>
            <li>On startup, the telemetry queue is cleared.</li>
            <li>All ‚Äúremote logger/dispatcher‚Äù interfaces resolve to no-op implementations.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- PLATFORM GUARDRAILS -->
    <section>
      <h2>Platform Guardrails & Version Notes</h2>
      <div class="panel">
        <ul class="list">
          <li>USB guarding prefers <code>setUsbDataSignalingEnabled</code> on Android 14/15+ and falls back to
              <code>DISALLOW_USB_FILE_TRANSFER</code> on Android 7+.</li>
          <li><code>forceStopPackage</code> is invoked only on Android 7.0+ when available to a DO.</li>
          <li>Bluetooth monitoring honors <code>BLUETOOTH_CONNECT</code> (12+) or legacy permissions; if missing, the
              system defaults to ‚Äúdisconnected‚Äù without crashing.</li>
          <li>Foreground service types are set appropriately across OS versions; the service will not start without user notification consent on 13+.</li>
        </ul>
      </div>
    </section>

    <!-- CONCLUSION -->
    <section class="panel">
      <h2>Summary</h2>
      <p>
        The DO configuration above reflects exactly what the app enforces on-device and <strong>does not</strong>
        add any networked behaviors to LockLoom servers. All sensitive operations (lock, wipe, hide apps, USB guard, force-stop)
        are strictly local. Distress alerts go directly to user-configured emergency contacts via SMS and email ‚Äî never through any backend.
      </p>
      <p>
        <strong>User consent is paramount:</strong> Both Accessibility Service usage and Phone Number data collection require
        explicit in-app consent with immutable timestamp recording. Features are gated until consent is granted, ensuring
        compliance with Google Play's User Data Policy.
      </p>
      <p class="note" style="margin-top:12px;">
        Last updated: January 14, 2026 (Build 347+)
      </p>
    </section>
  </main>
</body>
</html>
